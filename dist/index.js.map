{"version":3,"sources":["../src/actions.ts","../src/okx/core/http-client.ts","../src/okx/api/dex.ts","../src/okx/api/bridge.ts","../src/okx/core/client.ts","../src/index.ts"],"sourcesContent":["// src/actions.ts\nimport {\n    generateText,\n    type HandlerCallback,\n    type IAgentRuntime,\n    type Memory,\n    ModelClass,\n    type State,\n    composeContext,\n    type Action,\n    type ActionExample,\n} from \"@elizaos/core\";\nimport { OKXDexClient } from \"../src/okx/core/client\";\nimport {\n    TokenInfo,\n    APIResponse,\n    FormattedSwapResponse,\n    QuoteData,\n    TokenListInfo,\n    SwapExecutionData,\n} from \"./okx/types\";\n\n// Validate and format Solana address\nfunction formatSolanaAddress(address: string): string {\n    // Remove any whitespace\n    address = address.trim();\n\n    // Handle native SOL case\n    if (address.toLowerCase() === \"11111111111111111111111111111111\") {\n        return \"11111111111111111111111111111111\";\n    }\n\n    // Special case for SOL\n    if (address.toLowerCase() === \"sol\") {\n        return \"11111111111111111111111111111111\";\n    }\n\n    // Basic validation for Solana address format\n    if (!/^[1-9A-HJ-NP-Za-km-z]{32,44}$/.test(address)) {\n        throw new Error(`Invalid Solana address format: ${address}`);\n    }\n\n    // Keep original casing as Solana addresses are case-sensitive\n    return address;\n}\n\nasync function extractSwapParams(message: Memory, client: OKXDexClient) {\n    // Parse message content\n    let messageContent = \"\";\n    if (typeof message.content === \"string\") {\n        messageContent = message.content;\n    } else if (message.content && typeof message.content === \"object\") {\n        messageContent =\n            (message.content as any).text || JSON.stringify(message.content);\n    }\n\n    console.log(\"Processing message content:\", messageContent);\n    messageContent = messageContent.trim();\n\n    // Extract amount and tokens with more flexible patterns\n    const patterns = [\n        // Match \"300 <address> to <address>\"\n        /(?:quote|swap)?\\s*(?:for)?\\s*([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)\\s*([\\w.-]+)\\s*(?:to|for|->|=>)\\s*([\\w.-]+)/i,\n        // Match \"from <address> to <address> amount 300\"\n        /from\\s*([\\w.-]+)\\s*(?:to|for|->|=>)\\s*([\\w.-]+)\\s*(?:amount|quantity)?\\s*([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)/i,\n        // Legacy format\n        /from_token:\\s*([\\w.-]+)\\s*to_token:\\s*([\\w.-]+)\\s*amount:\\s*([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)/i,\n    ];\n\n    let fromToken = \"\";\n    let toToken = \"\";\n    let amount = \"\";\n\n    // Try each pattern\n    for (const pattern of patterns) {\n        const match = messageContent.match(pattern);\n        if (match) {\n            if (pattern.source.startsWith(\"from\")) {\n                [, fromToken, toToken, amount] = match;\n            } else {\n                [, amount, fromToken, toToken] = match;\n            }\n            console.log(\"Pattern matched:\", {\n                pattern: pattern.source,\n                fromToken,\n                toToken,\n                amount,\n            });\n            break;\n        }\n    }\n\n    // If not found in combined patterns, try individual patterns\n    if (!amount || !fromToken || !toToken) {\n        const amountMatch = messageContent.match(\n            /([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)/,\n        );\n        const fromMatch =\n            messageContent.match(/from\\s*([\\w.-]+)/i) ||\n            messageContent.match(/(?:^|\\s)([\\w.-]+)(?:\\s|$)/);\n        const toMatch = messageContent.match(/to\\s*([\\w.-]+)/i);\n\n        amount = amount || amountMatch?.[1] || \"\";\n        fromToken = fromToken || fromMatch?.[1] || \"\";\n        toToken = toToken || toMatch?.[1] || \"\";\n    }\n\n    // Format addresses\n    try {\n        fromToken = formatSolanaAddress(fromToken);\n        toToken = formatSolanaAddress(toToken);\n    } catch (error) {\n        throw new Error(\n            `Address format error: ${error instanceof Error ? error.message : String(error)}`,\n        );\n    }\n\n    console.log(\"Processed tokens:\", { fromToken, toToken });\n\n    // Basic validation\n    if (!fromToken) {\n        throw new Error(\n            \"Could not determine the source token address. \" +\n                \"Please provide a valid Solana token address. \" +\n                \"Example: 'quote for 300 EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v to 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN'\",\n        );\n    }\n\n    if (!toToken) {\n        throw new Error(\n            \"Could not determine the target token address. \" +\n                \"Please provide a valid Solana token address. \" +\n                \"Example: 'quote for 300 EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v to 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN'\",\n        );\n    }\n\n    if (!amount) {\n        throw new Error(\n            \"Could not determine the amount to swap. \" +\n                \"Please specify the amount. \" +\n                \"Example: 'quote for 300 EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v to 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN'\",\n        );\n    }\n\n    try {\n        // Get the quote first to get token decimals\n        const preQuote = await client.dex.getQuote({\n            chainId: \"501\",\n            fromTokenAddress: fromToken,\n            toTokenAddress: toToken,\n            amount: \"10000000000\", // Dummy amount to get token info\n            slippage: \"0.1\",\n        });\n\n        if (preQuote.code !== \"0\" || !preQuote.data?.[0]) {\n            throw new Error(preQuote.msg || \"Failed to get token information\");\n        }\n\n        // Get decimals from the response\n        const fromDecimals = parseInt(preQuote.data[0].fromToken.decimal);\n\n        // Parse amount and convert to smallest unit\n        const parsedAmount = parseFloat(amount);\n        if (isNaN(parsedAmount)) {\n            throw new Error(`Invalid amount value: ${amount}`);\n        }\n\n        // Convert to smallest unit using the correct decimals\n        const amountInSmallestUnit = Math.floor(\n            parsedAmount * Math.pow(10, fromDecimals),\n        ).toString();\n\n        console.log(\"Conversion details:\", {\n            originalAmount: amount,\n            parsedAmount,\n            fromDecimals,\n            amountInSmallestUnit,\n        });\n\n        return {\n            fromTokenAddress: fromToken,\n            toTokenAddress: toToken,\n            amount: amountInSmallestUnit,\n        };\n    } catch (error) {\n        console.error(\"Error in extractSwapParams:\", error);\n        throw new Error(\n            `Failed to process swap parameters: ${error instanceof Error ? error.message : String(error)}`,\n        );\n    }\n}\nfunction formatQuoteResponse(\n    data: QuoteData | SwapExecutionData,\n): FormattedSwapResponse {\n    // Extract the relevant data whether it's a quote or swap response\n    const quote = \"routerResult\" in data ? data.routerResult : data;\n\n    // Get decimals from the response\n    const fromDecimals = parseInt(quote.fromToken.decimal);\n    const toDecimals = parseInt(quote.toToken.decimal);\n\n    // Convert amounts using the decimals from the response\n    const displayFromAmount = (\n        Number(quote.fromTokenAmount) / Math.pow(10, fromDecimals)\n    ).toFixed(6);\n\n    const displayToAmount = (\n        Number(quote.toTokenAmount) / Math.pow(10, toDecimals)\n    ).toFixed(6);\n\n    return {\n        success: true,\n        quote: {\n            fromToken: {\n                symbol: quote.fromToken.tokenSymbol,\n                amount: displayFromAmount,\n                decimal: quote.fromToken.decimal,\n                unitPrice: quote.fromToken.tokenUnitPrice,\n            },\n            toToken: {\n                symbol: quote.toToken.tokenSymbol,\n                amount: displayToAmount,\n                decimal: quote.toToken.decimal,\n                unitPrice: quote.toToken.tokenUnitPrice,\n            },\n            priceImpact: quote.priceImpactPercentage + \"%\",\n            dexRoutes: quote.quoteCompareList.map((route) => ({\n                dex: route.dexName,\n                amountOut: route.amountOut,\n                fee: route.tradeFee,\n            })),\n        },\n\n        summary:\n            `Quote for ${displayFromAmount} ${quote.fromToken.tokenSymbol} to ${quote.toToken.tokenSymbol}:\\n` +\n            `Expected output: ${displayToAmount} ${quote.toToken.tokenSymbol}\\n` +\n            `Price impact: ${quote.priceImpactPercentage}%`,\n    };\n}\n\nfunction getActionHandler(\n    actionName: string,\n    actionDescription: string,\n    client: OKXDexClient,\n) {\n    return async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State | undefined,\n        options?: Record<string, unknown>,\n        callback?: HandlerCallback,\n    ): Promise<boolean> => {\n        let currentState = state ?? (await runtime.composeState(message));\n        currentState = await runtime.updateRecentMessageState(currentState);\n\n        try {\n            let result;\n\n            switch (actionName) {\n                case \"GET_CHAIN_DATA\":\n                    const chainData =\n                        await client.dex.getSupportedChains(\"501\");\n                    result = {\n                        chains: chainData.data.map((chain) => ({\n                            id: chain.chainId,\n                            name: chain.chainName,\n                            dexApprovalAddress:\n                                chain.dexTokenApproveAddress || null,\n                        })),\n                    };\n                    break;\n\n                case \"GET_LIQUIDITY_PROVIDERS\":\n                    result = await client.dex.getLiquidity(\"501\");\n                    break;\n\n                case \"GET_SWAP_QUOTE\": {\n                    const params = await extractSwapParams(message, client);\n                    console.log(\"Sending quote request with params:\", params);\n\n                    const quoteResult = await client.dex.getQuote({\n                        chainId: \"501\",\n                        fromTokenAddress: params.fromTokenAddress,\n                        toTokenAddress: params.toTokenAddress,\n                        amount: params.amount,\n                        slippage: \"0.1\",\n                        userWalletAddress: process.env.OKX_WALLET_ADDRESS,\n                    });\n\n                    console.log(\n                        \"Received quote result:\",\n                        JSON.stringify(quoteResult, null, 2),\n                    );\n\n                    if (quoteResult.code === \"0\" && quoteResult.data?.[0]) {\n                        result = formatQuoteResponse(quoteResult.data[0]);\n                    } else {\n                        throw new Error(\n                            quoteResult.msg || \"Failed to get quote\",\n                        );\n                    }\n                    break;\n                }\n\n                case \"GET_SWAP_TRANSACTION_DATA\": {\n                    const params = await extractSwapParams(message, client);\n\n                    const swapResponse = await client.dex.getSwapData({\n                        chainId: \"501\",\n                        fromTokenAddress: params.fromTokenAddress,\n                        toTokenAddress: params.toTokenAddress,\n                        amount: params.amount,\n                        slippage: \"0.5\",\n                        // autoSlippage: true,\n                        // maxAutoSlippage: \"1000\",\n                        userWalletAddress: process.env.OKX_WALLET_ADDRESS,\n                    });\n\n                    if (swapResponse.code !== \"0\" || !swapResponse.data?.[0]) {\n                        throw new Error(\n                            swapResponse.msg ||\n                                \"Failed to get swap transaction data\",\n                        );\n                    }\n\n                    result = formatQuoteResponse(swapResponse.data[0]);\n\n                    const swapData = swapResponse.data[0];\n    \n                    // Extract transaction data\n                    const transactionData = {\n                        chainId: swapData.routerResult.chainId,\n                        estimateGasFee: swapData.routerResult.estimateGasFee,\n                        tx: swapData.tx || null\n                    };\n                \n                    const txData = {\n                        ...formatQuoteResponse(swapData),\n                        transaction: transactionData\n                    };\n                    console.log('OKX Swap Result:', JSON.stringify(txData, null, 2));\n\n                    break;\n                }\n\n                case \"GET_AVAILABLE_TOKENS\":\n                    result = await client.dex.getTokens(\"501\");\n                    break;\n\n                case \"EXECUTE_SWAP\": {\n                    const params = await extractSwapParams(message, client);\n                    console.log(\"Getting swap data with params:\", params);\n\n                    // First get the swap data with proper parameters\n                    const swapResponse = await client.dex.getSwapData({\n                        chainId: \"501\",\n                        fromTokenAddress: params.fromTokenAddress,\n                        toTokenAddress: params.toTokenAddress,\n                        amount: params.amount,\n                        slippage: \"0.5\",\n                        userWalletAddress: process.env.OKX_WALLET_ADDRESS,\n                    });\n\n                    console.log(\n                        \"Received swap data response:\",\n                        JSON.stringify(swapResponse, null, 2),\n                    );\n\n                    if (swapResponse.code !== \"0\" || !swapResponse.data?.[0]) {\n                        throw new Error(\n                            swapResponse?.msg || \"Failed to get swap data\",\n                        );\n                    }\n\n                    // Get the router result which contains our token data\n                    const routerResult = swapResponse.data[0];\n                    const txData = swapResponse.data[0].tx;\n\n                    if (\n                        !routerResult.routerResult?.fromToken?.decimal ||\n                        !routerResult.routerResult?.toToken?.decimal\n                    ) {\n                        console.error(\n                            \"Missing decimal information in token data:\",\n                            routerResult,\n                        );\n                        throw new Error(\"Invalid token decimal information\");\n                    }\n\n                    // Format the amounts for display using actual token decimal data\n                    const { routerResult: swapResult } = routerResult;\n                    const fromDecimals = parseInt(swapResult.fromToken.decimal);\n                    const toDecimals = parseInt(swapResult.toToken.decimal);\n\n                    const displayFromAmount = (\n                        parseFloat(swapResult.fromTokenAmount) /\n                        Math.pow(10, fromDecimals)\n                    ).toFixed(6);\n\n                    const displayToAmount = (\n                        parseFloat(swapResult.toTokenAmount) /\n                        Math.pow(10, toDecimals)\n                    ).toFixed(6);\n\n                    console.log(\"Executing swap with data:\", {\n                        fromToken: swapResult.fromToken.tokenSymbol,\n                        toToken: swapResult.toToken.tokenSymbol,\n                        fromAmount: displayFromAmount,\n                        expectedOutput: displayToAmount,\n                        priceImpact: swapResult.priceImpactPercentage,\n                    });\n\n                    // Execute the swap with the same parameters\n                    const executeResult = await client.dex.executeSwap({\n                        chainId: \"501\",\n                        fromTokenAddress: params.fromTokenAddress,\n                        toTokenAddress: params.toTokenAddress,\n                        amount: params.amount,\n                        slippage: \"0.5\",\n                        userWalletAddress: process.env.OKX_WALLET_ADDRESS,\n                    });\n\n                    // Format the result for display\n                    const formattedResult = {\n                        success: executeResult.success,\n                        transaction: {\n                            id: executeResult.transactionId,\n                            explorerUrl: executeResult.explorerUrl,\n                        },\n                        swapDetails: {\n                            fromToken: {\n                                symbol: swapResult.fromToken.tokenSymbol,\n                                amount: displayFromAmount,\n                                decimal: swapResult.fromToken.decimal,\n                            },\n                            toToken: {\n                                symbol: swapResult.toToken.tokenSymbol,\n                                amount: displayToAmount,\n                                decimal: swapResult.toToken.decimal,\n                            },\n                            priceImpact: swapResult.priceImpactPercentage + \"%\",\n                            route:\n                                swapResult.quoteCompareList[0]?.dexName ||\n                                \"Unknown\",\n                            txData: txData?.data,\n                        },\n                        summary:\n                            `Swap executed successfully!\\n` +\n                            `Swapped ${displayFromAmount} ${swapResult.fromToken.tokenSymbol} for approximately ${displayToAmount} ${swapResult.toToken.tokenSymbol}\\n` +\n                            `Price Impact: ${swapResult.priceImpactPercentage}%\\n` +\n                            `Transaction ID: ${executeResult.transactionId}\\n` +\n                            `View on Explorer: ${executeResult.explorerUrl}`,\n                    };\n\n                    result = formattedResult;\n                    break;\n                }\n\n                default:\n                    throw new Error(`Unknown action: ${actionName}`);\n            }\n\n            const response = await generateText({\n                runtime,\n                context: composeContext({\n                    state: currentState,\n                    template: JSON.stringify(result),\n                }),\n                modelClass: ModelClass.SMALL,\n            });\n\n            callback?.({\n                text: response,\n                content: result,\n            });\n            return true;\n        } catch (error) {\n            const errorMessage =\n                error instanceof Error ? error.message : String(error);\n            const errorResponse = await generateText({\n                runtime,\n                context: composeContext({\n                    state: currentState,\n                    template: `Error: ${errorMessage}`,\n                }),\n                modelClass: ModelClass.SMALL,\n            });\n\n            callback?.({\n                text: errorResponse,\n                content: { error: errorMessage },\n            });\n            return false;\n        }\n    };\n}\n\nexport async function getOKXActions(\n    getSetting: (key: string) => string | undefined,\n) {\n    const actionsWithoutHandler: Omit<Action, \"handler\">[] = [\n        {\n            name: \"GET_CHAIN_DATA\",\n            description: \"Get Solana chain data from OKX DEX\",\n            similes: [],\n            validate: async () => true,\n            examples: [],\n        },\n        {\n            name: \"GET_LIQUIDITY_PROVIDERS\",\n            description: \"Get liquidity providers on Solana from OKX DEX\",\n            similes: [],\n            validate: async () => true,\n            examples: [],\n        },\n        {\n            name: \"GET_SWAP_QUOTE\",\n            description: \"Get a swap quote for tokens on Solana\",\n            similes: [],\n            validate: async () => true,\n            examples: [\n                [\n                    {\n                        user: \"user\",\n                        content: {\n                            text: \"Get quote from_token: SOL123 to_token: USDC456 amount: 1.5\",\n                        },\n                    },\n                    {\n                        user: \"assistant\",\n                        content: {\n                            text: \"Getting quote for swapping 1.5 SOL123 to USDC456...\",\n                        },\n                    },\n                ],\n                [\n                    {\n                        user: \"user\",\n                        content: {\n                            text: \"Get quote from SOL123 to USDC456 amount 1.5\",\n                        },\n                    },\n                    {\n                        user: \"assistant\",\n                        content: {\n                            text: \"Fetching quote for 1.5 tokens from SOL123 to USDC456...\",\n                        },\n                    },\n                ],\n            ],\n        },\n        {\n            name: \"GET_SWAP_TRANSACTION_DATA\",\n            description: \"Get swap transaction data for tokens on Solana\",\n            similes: [],\n            validate: async () => true,\n            examples: [\n                [\n                    {\n                        user: \"user\",\n                        content: {\n                            text: \"Get swap transaction data from_token: SOL123 to_token: USDC456 amount: 1.5\",\n                        },\n                    },\n                    {\n                        user: \"assistant\",\n                        content: {\n                            text: \"Getting swap transaction data for 1.5 SOL123 to USDC456...\",\n                        },\n                    },\n                ],\n            ],\n        },\n        {\n            name: \"GET_AVAILABLE_TOKENS\",\n            description: \"Get available tokens for swapping on Solana\",\n            similes: [],\n            validate: async () => true,\n            examples: [],\n        },\n        {\n            name: \"EXECUTE_SWAP\",\n            description: \"Execute a token swap on Solana using OKX DEX\",\n            similes: [],\n            validate: async () => true,\n            examples: [\n                [\n                    {\n                        user: \"user\",\n                        content: {\n                            text: \"Swap from_token: SOL123 to_token: USDC456 amount: 1.5\",\n                        },\n                    },\n                    {\n                        user: \"assistant\",\n                        content: {\n                            text: \"Executing swap of 1.5 tokens from SOL123 to USDC456...\",\n                        },\n                    },\n                ],\n                [\n                    {\n                        user: \"user\",\n                        content: { text: \"Swap 1.5 from SOL123 to USDC456\" },\n                    },\n                    {\n                        user: \"assistant\",\n                        content: {\n                            text: \"Processing swap of 1.5 tokens from SOL123 to USDC456...\",\n                        },\n                    },\n                ],\n            ],\n        },\n    ];\n\n    const client = new OKXDexClient({\n        apiKey: getSetting(\"OKX_API_KEY\")!,\n        secretKey: getSetting(\"OKX_SECRET_KEY\")!,\n        apiPassphrase: getSetting(\"OKX_API_PASSPHRASE\")!,\n        projectId: getSetting(\"OKX_PROJECT_ID\")!,\n        solana: {\n            connection: {\n                rpcUrl: getSetting(\"OKX_SOLANA_RPC_URL\")!,\n                // wsEndpoint: getSetting(\"OKX_WS_ENDPONT\"),\n            },\n            privateKey: getSetting(\"OKX_WALLET_PRIVATE_KEY\")!,\n        },\n    });\n\n    return actionsWithoutHandler.map((action) => ({\n        ...action,\n        handler: getActionHandler(action.name, action.description, client),\n    }));\n}\n","import CryptoJS from 'crypto-js';\nimport { OKXConfig } from '../types';\n\nclass APIError extends Error {\n    constructor(\n        message: string,\n        public status?: number,\n        public statusText?: string,\n        public responseBody?: any,\n        public requestDetails?: {\n            method: string,\n            path: string,\n            params?: Record<string, string | undefined>,\n            queryString?: string\n        }\n    ) {\n        super(message);\n        this.name = 'APIError';\n    }\n}\n\nexport class HTTPClient {\n    private readonly config: OKXConfig;\n\n    constructor(config: OKXConfig) {\n        this.config = {\n            baseUrl: 'https://www.okx.com',\n            maxRetries: 3,\n            timeout: 30000,\n            ...config\n        };\n    }\n\n    private getHeaders(timestamp: string, method: string, path: string, queryString = \"\") {\n        const stringToSign = timestamp + method + path + queryString;\n\n        return {\n            \"Content-Type\": \"application/json\",\n            \"OK-ACCESS-KEY\": this.config.apiKey,\n            \"OK-ACCESS-SIGN\": CryptoJS.enc.Base64.stringify(\n                CryptoJS.HmacSHA256(stringToSign, this.config.secretKey)\n            ),\n            \"OK-ACCESS-TIMESTAMP\": timestamp,\n            \"OK-ACCESS-PASSPHRASE\": this.config.apiPassphrase,\n            \"OK-ACCESS-PROJECT\": this.config.projectId,\n        };\n    }\n\n    private async handleErrorResponse(response: Response, requestDetails: any) {\n        let responseBody;\n        try {\n            responseBody = await response.json();\n        } catch (e) {\n            responseBody = await response.text();\n        }\n\n        throw new APIError(\n            `HTTP error! status: ${response.status}`,\n            response.status,\n            response.statusText,\n            responseBody,\n            requestDetails\n        );\n    }\n\n    async request<T>(method: string, path: string, params?: Record<string, string | undefined>): Promise<T> {\n        const timestamp = new Date().toISOString();\n\n        // Filter out undefined values from params\n        const cleanParams = params ? Object.fromEntries(\n            Object.entries(params).filter(([_, v]) => v !== undefined)\n        ) as Record<string, string> : undefined;\n\n        const queryString = cleanParams ? \"?\" + new URLSearchParams(cleanParams).toString() : \"\";\n        const headers = this.getHeaders(timestamp, method, path, queryString);\n        const requestDetails = {\n            method,\n            path,\n            params: cleanParams,\n            queryString,\n            url: `${this.config.baseUrl}${path}${queryString}`\n        };\n\n        // Log request details in development\n        if (process.env.NODE_ENV === 'development') {\n            console.log('Request Details:', {\n                url: requestDetails.url,\n                method: requestDetails.method,\n                headers: {\n                    ...headers,\n                    'OK-ACCESS-SIGN': '***', // Hide sensitive data\n                    'OK-ACCESS-KEY': '***',\n                    'OK-ACCESS-PASSPHRASE': '***'\n                },\n                params: requestDetails.params\n            });\n        }\n\n        let retries = 0;\n        while (retries < this.config.maxRetries!) {\n            try {\n                const response = await fetch(`${this.config.baseUrl}${path}${queryString}`, {\n                    method,\n                    headers\n                });\n\n                if (!response.ok) {\n                    await this.handleErrorResponse(response, requestDetails);\n                }\n\n                const data = await response.json();\n\n                // Log response in development\n                if (process.env.NODE_ENV === 'development') {\n                    console.log('Response:', JSON.stringify(data, null, 2));\n                }\n\n                if (data.code !== \"0\") {\n                    throw new APIError(\n                        `API Error: ${data.msg}`,\n                        response.status,\n                        response.statusText,\n                        data,\n                        requestDetails\n                    );\n                }\n\n                return data as T;\n            } catch (error) {\n                if (error instanceof APIError) {\n                    if (retries === this.config.maxRetries! - 1) throw error;\n                } else {\n                    if (retries === this.config.maxRetries! - 1) {\n                        throw new APIError(\n                            error instanceof Error ? error.message : 'Unknown error',\n                            undefined,\n                            undefined,\n                            undefined,\n                            requestDetails\n                        );\n                    }\n                }\n                retries++;\n                await new Promise(resolve => setTimeout(resolve, 1000 * retries));\n            }\n        }\n        throw new Error(\"Max retries exceeded\");\n    }\n}","// src/api/dex.ts\nimport { HTTPClient } from \"../core/http-client\";\nimport {\n    SwapParams,\n    SlippageOptions,\n    OKXConfig,\n    QuoteParams,\n    QuoteData,\n    APIResponse,\n    APIRequestParams,\n    SwapResult,\n    NetworkConfigs,\n    ChainConfig,\n    SwapResponseData,\n    ChainData,\n} from \"../types\";\nimport base58 from \"bs58\";\nimport * as solanaWeb3 from \"@solana/web3.js\";\nimport { Connection } from \"@solana/web3.js\";\n\nexport class DexAPI {\n    private readonly defaultNetworkConfigs: NetworkConfigs = {\n        \"501\": {\n            id: \"501\",\n            explorer: \"https://solscan.io/tx\",\n            defaultSlippage: \"0.5\",\n            maxSlippage: \"1\",\n            computeUnits: 300000,\n            confirmationTimeout: 60000,\n            maxRetries: 3,\n        },\n    };\n\n    constructor(\n        private readonly client: HTTPClient,\n        private readonly config: OKXConfig\n    ) {\n        // Merge default configs with provided configs\n        this.config.networks = {\n            ...this.defaultNetworkConfigs,\n            ...(config.networks || {}),\n        };\n    }\n\n    private getNetworkConfig(chainId: string): ChainConfig {\n        const networkConfig = this.config.networks?.[chainId];\n        if (!networkConfig) {\n            throw new Error(\n                `Network configuration not found for chain ${chainId}`\n            );\n        }\n        return networkConfig;\n    }\n\n    // Convert params to API format\n    private toAPIParams(params: Record<string, any>): APIRequestParams {\n        const apiParams: APIRequestParams = {};\n\n        for (const [key, value] of Object.entries(params)) {\n            if (value !== undefined) {\n                if (key === \"autoSlippage\") {\n                    apiParams[key] = value ? \"true\" : \"false\";\n                } else {\n                    apiParams[key] = String(value);\n                }\n            }\n        }\n\n        return apiParams;\n    }\n\n    async getQuote(params: QuoteParams): Promise<APIResponse<QuoteData>> {\n        return this.client.request(\n            \"GET\",\n            \"/api/v5/dex/aggregator/quote\",\n            this.toAPIParams(params)\n        );\n    }\n\n    async getLiquidity(chainId: string): Promise<APIResponse<QuoteData>> {\n        return this.client.request(\n            \"GET\",\n            \"/api/v5/dex/aggregator/get-liquidity\",\n            this.toAPIParams({ chainId })\n        );\n    }\n\n    async getSupportedChains(chainId: string): Promise<APIResponse<ChainData>> {\n        return this.client.request(\n            \"GET\",\n            \"/api/v5/dex/aggregator/supported/chain\",\n            this.toAPIParams({ chainId })\n        );\n    }\n\n    async getSwapData(params: SwapParams): Promise<SwapResponseData> {\n        // Validate slippage parameters\n        if (!params.slippage && !params.autoSlippage) {\n            throw new Error(\"Either slippage or autoSlippage must be provided\");\n        }\n\n        if (params.slippage) {\n            const slippageValue = parseFloat(params.slippage);\n            if (\n                isNaN(slippageValue) ||\n                slippageValue < 0 ||\n                slippageValue > 1\n            ) {\n                throw new Error(\"Slippage must be between 0 and 1\");\n            }\n        }\n\n        if (params.autoSlippage && !params.maxAutoSlippage) {\n            throw new Error(\n                \"maxAutoSlippageBps must be provided when autoSlippage is enabled\"\n            );\n        }\n\n        return this.client.request(\n            \"GET\",\n            \"/api/v5/dex/aggregator/swap\",\n            this.toAPIParams(params)\n        );\n    }\n\n    async getTokens(chainId: string): Promise<APIResponse<QuoteData>> {\n        return this.client.request(\n            \"GET\",\n            \"/api/v5/dex/aggregator/all-tokens\",\n            this.toAPIParams({ chainId })\n        );\n    }\n\n    async executeSwap(params: SwapParams): Promise<SwapResult> {\n        const swapData = await this.getSwapData(params);\n\n        switch (params.chainId) {\n            case \"501\": // Solana\n                return this.executeSolanaSwap(swapData, params);\n            default:\n                throw new Error(\n                    `Chain ${params.chainId} not supported for swap execution`\n                );\n        }\n    }\n\n    // Update the executeSwap function to properly handle decimals\n    private async executeSolanaSwap(\n        swapData: SwapResponseData,\n        params: SwapParams\n    ): Promise<SwapResult> {\n        const networkConfig = this.getNetworkConfig(params.chainId);\n\n        if (!this.config.solana) {\n            throw new Error(\"Solana configuration required\");\n        }\n\n        // Get quote data\n        const quoteData = swapData.data?.[0];\n        if (!quoteData?.routerResult) {\n            throw new Error(\"Invalid swap data: missing router result\");\n        }\n\n        const { routerResult } = quoteData;\n\n        // Validate token information\n        if (\n            !routerResult.fromToken?.decimal ||\n            !routerResult.toToken?.decimal\n        ) {\n            throw new Error(\n                `Missing decimal information for tokens: ${routerResult.fromToken?.tokenSymbol} -> ${routerResult.toToken?.tokenSymbol}`\n            );\n        }\n\n        // Get transaction data\n        const txData = quoteData.tx?.data;\n        if (!txData) {\n            throw new Error(\"Missing transaction data\");\n        }\n\n        try {\n            // Decode private key and create keypair\n            const feePayer = solanaWeb3.Keypair.fromSecretKey(\n                base58.decode(this.config.solana.privateKey)\n            );\n\n            // Get latest blockhash\n            const connection = new Connection(\n                this.config.solana.connection.rpcUrl,\n                {\n                    commitment: \"confirmed\",\n                    wsEndpoint: this.config.solana.connection.wsEndpoint,\n                    confirmTransactionInitialTimeout:\n                        networkConfig.confirmationTimeout,\n                }\n            );\n            const { blockhash, lastValidBlockHeight } =\n                await connection.getLatestBlockhash(\"confirmed\");\n\n            // Decode and prepare transaction\n            const decodedTransaction = base58.decode(txData);\n            let transaction:\n                | solanaWeb3.Transaction\n                | solanaWeb3.VersionedTransaction;\n\n            try {\n                // Try versioned transaction first\n                transaction =\n                    solanaWeb3.VersionedTransaction.deserialize(\n                        decodedTransaction\n                    );\n                (\n                    transaction as solanaWeb3.VersionedTransaction\n                ).message.recentBlockhash = blockhash;\n            } catch {\n                // Fall back to legacy transaction\n                transaction = solanaWeb3.Transaction.from(decodedTransaction);\n                (transaction as solanaWeb3.Transaction).recentBlockhash =\n                    blockhash;\n                (transaction as solanaWeb3.Transaction).feePayer =\n                    feePayer.publicKey;\n\n                // Add compute budget for legacy transactions\n                const computeBudgetIx =\n                    solanaWeb3.ComputeBudgetProgram.setComputeUnitLimit({\n                        units: this.config.solana.computeUnits || 300000,\n                    });\n                (transaction as solanaWeb3.Transaction).add(computeBudgetIx);\n            }\n\n            // Sign transaction\n            if (transaction instanceof solanaWeb3.VersionedTransaction) {\n                transaction.sign([feePayer]);\n            } else {\n                transaction.sign(feePayer);\n            }\n\n            // Send transaction\n            const signature = await connection.sendRawTransaction(\n                transaction.serialize(),\n                {\n                    skipPreflight: false,\n                    maxRetries: networkConfig.maxRetries,\n                    preflightCommitment: \"confirmed\",\n                }\n            );\n\n            // Confirm transaction\n            const confirmation = await connection.confirmTransaction(\n                {\n                    signature,\n                    blockhash,\n                    lastValidBlockHeight,\n                },\n                \"confirmed\"\n            );\n\n            if (confirmation.value.err) {\n                throw new Error(\n                    `Transaction failed: ${JSON.stringify(\n                        confirmation.value.err\n                    )}`\n                );\n            }\n\n            // Format amounts using proper decimals\n            const fromDecimals = parseInt(routerResult.fromToken.decimal);\n            const toDecimals = parseInt(routerResult.toToken.decimal);\n\n            const displayFromAmount = (\n                Number(routerResult.fromTokenAmount) /\n                Math.pow(10, fromDecimals)\n            ).toFixed(6);\n\n            const displayToAmount = (\n                Number(routerResult.toTokenAmount) / Math.pow(10, toDecimals)\n            ).toFixed(6);\n\n            return {\n                success: true,\n                transactionId: signature,\n                explorerUrl: `${networkConfig.explorer}/${signature}`,\n                details: {\n                    fromToken: {\n                        symbol: routerResult.fromToken.tokenSymbol,\n                        amount: displayFromAmount,\n                        decimal: routerResult.fromToken.decimal,\n                    },\n                    toToken: {\n                        symbol: routerResult.toToken.tokenSymbol,\n                        amount: displayToAmount,\n                        decimal: routerResult.toToken.decimal,\n                    },\n                    priceImpact: routerResult.priceImpactPercentage,\n                },\n            };\n        } catch (error) {\n            console.error(\"Swap execution failed:\", error);\n            throw error;\n        }\n    }\n}\n","// src/api/bridge.ts\n\nimport { HTTPClient } from '../core/http-client';\n\nexport interface CrossChainQuoteParams {\n    [key: string]: string | undefined;\n    fromChainId: string;\n    toChainId: string;\n    fromTokenAddress: string;\n    toTokenAddress: string;\n    amount: string;\n    slippage: string;\n    sort?: string;\n    feePercent?: string;\n    allowBridge?: string;\n    denyBridge?: string;\n    priceImpactProtectionPercentage?: string;\n}\n\nexport interface CrossChainSwapParams extends CrossChainQuoteParams {\n    userWalletAddress: string;\n    receiveAddress?: string;\n    referrerAddress?: string;\n    onlyBridge?: string;\n    memo?: string;\n}\n\nexport class BridgeAPI {\n    constructor(private readonly client: HTTPClient) { }\n\n    // Get tokens supported for cross-chain transfers\n    async getSupportedTokens(chainId: string) {\n        return this.client.request('GET', '/api/v5/dex/cross-chain/supported/tokens', { chainId });\n    }\n\n    // Get supported bridges for a chain\n    async getSupportedBridges(chainId: string) {\n        return this.client.request('GET', '/api/v5/dex/cross-chain/supported/bridges', { chainId });\n    }\n\n    // Get token pairs available for bridging\n    async getBridgeTokenPairs(fromChainId: string) {\n        return this.client.request('GET', '/api/v5/dex/cross-chain/supported/bridge-tokens-pairs',\n            { fromChainId });\n    }\n\n    // Get quote for a cross-chain swap\n    async getCrossChainQuote(params: CrossChainQuoteParams) {\n        // Validate slippage\n        const slippageValue = parseFloat(params.slippage);\n        if (isNaN(slippageValue) || slippageValue < 0.002 || slippageValue > 0.5) {\n            throw new Error('Slippage must be between 0.002 (0.2%) and 0.5 (50%)');\n        }\n\n        return this.client.request('GET', '/api/v5/dex/cross-chain/quote', params);\n    }\n\n    // Build cross-chain swap transaction\n    async buildCrossChainSwap(params: CrossChainSwapParams) {\n        // Validate required parameters\n        if (!params.userWalletAddress) {\n            throw new Error('userWalletAddress is required');\n        }\n\n        return this.client.request('GET', '/api/v5/dex/cross-chain/build-tx', params);\n    }\n}","// src/core/client.ts\nimport { HTTPClient } from \"./http-client\";\nimport { DexAPI } from \"../api/dex\";\nimport { BridgeAPI } from \"../api/bridge\";\nimport type { OKXConfig } from \"../types\";\n\nexport class OKXDexClient {\n    private config: OKXConfig;\n    private httpClient: HTTPClient;\n    public dex: DexAPI;\n    public bridge: BridgeAPI;\n\n    constructor(config: OKXConfig) {\n        this.config = {\n            baseUrl: \"https://www.okx.com\",\n            maxRetries: 3,\n            timeout: 30000,\n            ...config,\n        };\n\n        this.httpClient = new HTTPClient(this.config);\n        this.dex = new DexAPI(this.httpClient, this.config);\n        this.bridge = new BridgeAPI(this.httpClient);\n    }\n}\n","// src/index.ts\nimport type { Plugin, Character } from \"@elizaos/core\";\nimport { getOKXActions } from \"./actions\";\n\nexport const OKXPlugin = async (character: Character): Promise<Plugin> => {\n    const getSetting = (key: string) => character.settings?.secrets?.[key] || process.env[key];\n    \n    // Validate required settings\n    const requiredSettings = [\n        \"OKX_API_KEY\",\n        \"OKX_SECRET_KEY\",\n        \"OKX_API_PASSPHRASE\",\n        \"OKX_PROJECT_ID\",\n        \"OKX_SOLANA_RPC_URL\",\n        \"OKX_WALLET_PRIVATE_KEY\",\n    ];\n\n    const missingSettings = requiredSettings.filter(\n        (setting) => !getSetting(setting),\n    );\n    if (missingSettings.length > 0) {\n        console.warn(\n            `Missing required settings for OKX plugin: ${missingSettings.join(\", \")}`\n        );\n        return {\n            name: \"OKX DEX Plugin\",\n            description: \"OKX DEX integration for Solana swaps\",\n            providers: [],\n            evaluators: [],\n            services: [],\n            actions: [],\n        };\n    }\n\n    try {\n        console.log(\"Initializing OKX DEX Plugin...\");\n        const actions = await getOKXActions(getSetting);\n        \n        // Simple action display\n        console.log(\"\\nAvailable Actions:\");\n        actions.forEach(action => {\n            console.log(`- ${action.name}: ${action.description}`);\n        });\n        \n        return {\n            name: \"OKX DEX Plugin\",\n            description: \"OKX DEX integration for Solana swaps\",\n            providers: [],\n            evaluators: [],\n            services: [],\n            actions,\n        };\n    } catch (error) {\n        console.error(\"Error initializing OKX plugin:\", error);\n        throw error;\n    }\n};\n\nexport default OKXPlugin;"],"mappings":"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","names":[]}